Collecting Tweets from @ESA\_Rosetta and @Philae2014
================
Patrick Hausmann
11.03.2018

``` r
library(rtweet)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(readr)
```

Try to answer this question (<https://www.facebook.com/groups/dataninja/permalink/1790684897903927/>)

Obtaining and using access tokens
---------------------------------

see (<https://cran.r-project.org/web/packages/rtweet/vignettes/auth.html>)

``` r
## whatever name you assigned to your created app
appname <- "esa_rosetta"

## api key (example below is not a real key)
key <- "uwaW......"

## api secret (example below is not a real key)
secret <- "1XQjryO7....."

## create token named "twitter_token"
twitter_token <- create_token(
  app = appname,
  consumer_key = key,
  consumer_secret = secret)

saveRDS(twitter_token, file = "twitter_token.rds")
```

Use stored twitter token to authorize
-------------------------------------

``` r
twitter_token <- readRDS("twitter_token.rds")
```

Collecting and saving tweets
----------------------------

``` r
tmls <- get_timelines(c("ESA_Rosetta", "Philae2014"), n = 3200)
glimpse(tmls)
```

    ## Observations: 3,458
    ## Variables: 42
    ## $ status_id              <chr> "781827468407795712", "7818259226473553...
    ## $ created_at             <dttm> 2016-09-30 12:06:08, 2016-09-30 12:00:...
    ## $ user_id                <chr> "253536357", "253536357", "253536357", ...
    ## $ screen_name            <chr> "ESA_Rosetta", "ESA_Rosetta", "ESA_Rose...
    ## $ text                   <chr> "#OnceUponATime #LivingWithAComet #Miss...
    ## $ source                 <chr> "Hootsuite", "Hootsuite", "Hootsuite", ...
    ## $ reply_to_status_id     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ reply_to_user_id       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ reply_to_screen_name   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ is_quote               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
    ## $ is_retweet             <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALS...
    ## $ favorite_count         <int> 2500, 5447, 6100, 1814, 1324, 798, 604,...
    ## $ retweet_count          <int> 1767, 4491, 4526, 1138, 642, 357, 318, ...
    ## $ hashtags               <list> [<"OnceUponATime", "LivingWithAComet",...
    ## $ symbols                <list> [NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
    ## $ urls_url               <list> ["youtube.com/watch?v=vcYo-qâ€¦", "ow.ly...
    ## $ urls_t.co              <list> ["https://t.co/wRI2zZjFMe", "https://t...
    ## $ urls_expanded_url      <list> ["https://www.youtube.com/watch?v=vcYo...
    ## $ media_url              <list> [NA, "http://pbs.twimg.com/media/Ctmai...
    ## $ media_t.co             <list> [NA, "https://t.co/MNuz622tNJ", "https...
    ## $ media_expanded_url     <list> [NA, "https://twitter.com/ESA_Rosetta/...
    ## $ media_type             <list> [NA, "photo", "photo", "photo", "photo...
    ## $ ext_media_url          <list> [NA, "http://pbs.twimg.com/media/Ctmai...
    ## $ ext_media_t.co         <list> [NA, "https://t.co/MNuz622tNJ", "https...
    ## $ ext_media_expanded_url <list> [NA, "https://twitter.com/ESA_Rosetta/...
    ## $ ext_media_type         <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ mentions_user_id       <list> ["103865085", NA, NA, NA, NA, NA, NA, ...
    ## $ mentions_screen_name   <list> ["esascience", NA, NA, NA, NA, NA, NA,...
    ## $ lang                   <chr> "und", "en", "und", "ja", "hi", "ar", "...
    ## $ quoted_status_id       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ quoted_text            <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ retweet_status_id      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ retweet_text           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ place_url              <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ place_name             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ place_full_name        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ place_type             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ country                <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ country_code           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
    ## $ geo_coords             <list> [<NA, NA>, <NA, NA>, <NA, NA>, <NA, NA...
    ## $ coords_coords          <list> [<NA, NA>, <NA, NA>, <NA, NA>, <NA, NA...
    ## $ bbox_coords            <list> [<NA, NA, NA, NA, NA, NA, NA, NA>, <NA...

``` r
saveRDS(tmls, file = "rosetta.rds")
```

Export selected columns as CSV
------------------------------

``` r
tmls1 <- tmls %>% 
         select(status_id:retweet_count)

tmls1 %>% 
      sample_n(3) %>% 
      select(created_at, screen_name, text, favorite_count, retweet_count) %>%
      knitr::kable()
```

| created\_at         | screen\_name | text                                                                                                                                               |  favorite\_count|  retweet\_count|
|:--------------------|:-------------|:---------------------------------------------------------------------------------------------------------------------------------------------------|----------------:|---------------:|
| 2015-07-01 08:28:46 | ESA\_Rosetta | \#ICYMI Thousands of \#67P images (now up to 19 Dec) are free to browse in my NAVCAM photo album <http://t.co/cvTPLkbjwC> <http://t.co/zyScBMkqsU> |              280|             281|
| 2012-01-30 14:03:10 | Philae2014   | @elakdawalla I'm not ignoring your question... I'm trying to get confirmation of the answer!                                                       |                0|               0|
| 2014-02-28 16:23:31 | ESA\_Rosetta | I hope you enjoyed the images! Feel free to browse through 100s of others via my dedicated website: <http://t.co/Wk0WDPIBsO>                       |               30|              17|

``` r
readr::write_excel_csv2(tmls1, path="rosetta.csv")
```
